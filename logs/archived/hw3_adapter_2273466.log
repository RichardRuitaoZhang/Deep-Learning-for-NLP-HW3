Starting Adapter Tuning fine-tuning on GPU...
Mon Dec  1 11:25:07 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 570.86.15              Driver Version: 570.86.15      CUDA Version: 12.8     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA A100-PCIE-40GB          On  |   00000000:86:00.0 Off |                    0 |
| N/A   20C    P0             29W /  250W |       1MiB /  40960MiB |      0%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI              PID   Type   Process name                        GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+
Using device: cuda
Loading pretrained weights from pretrain/model_weights ...

Adapter Tuning parameter summary:
  Total params:      144603985
  Trainable params:  1189632
  Trainable ratio:   0.8227%

Traceback (most recent call last):
  File "/gpfs/projects/b1080/rz/cs461/HW3/peft_adapter.py", line 238, in <module>
    main()
  File "/gpfs/projects/b1080/rz/cs461/HW3/peft_adapter.py", line 230, in main
    train_loss = train_loop(model, train_loader, crit, optim, args.device, id_list)
  File "/gpfs/projects/b1080/rz/cs461/HW3/peft_adapter.py", line 129, in train_loop
    logits = model(ids, mask)
  File "/home/mnr4714/miniconda3/envs/peft/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/mnr4714/miniconda3/envs/peft/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/gpfs/projects/b1080/rz/cs461/HW3/starter.py", line 264, in forward
    if self.opt.tied == 0:
AttributeError: 'Namespace' object has no attribute 'tied'
Adapter Tuning fine-tuning completed.
